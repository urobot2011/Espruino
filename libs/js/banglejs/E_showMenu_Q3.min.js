(function(m){g.clearRect(Bangle.appRect);Bangle.setLCDPower(1);if(m){var h=Object.keys(m),c=m[""];c&&h.splice(h.indexOf(""),1);c instanceof Object||(c={});c.fontHeight=c.fontHeight||21;void 0===c.selected&&(c.selected=0);var q=Bangle.appRect,r=q.x,n=q.x2,l=q.y,u=q.y2-12;c.title&&(l+=22);var t=require("locale"),d={lastIdx:0,draw:function(a,b){var p=0|Math.min((u-l)/c.fontHeight,h.length),f=E.clip(c.selected-(p>>1),0,h.length-p);f!=d.lastIdx&&(a=void 0);d.lastIdx=f;var e=l;
g.reset().setFontAlign(0,-1,0).setFont("12x20");void 0===a&&c.title&&g.drawString(c.title,(r+n)/2,l-21).drawLine(r,l-2,n,l-2).setColor(g.theme.fg).setBgColor(g.theme.bg);e+=12;g.setColor(0<f?g.theme.fg:g.theme.bg).fillPoly([72,e,104,e,88,e-12]);void 0!==a&&(f<a&&(e+=c.fontHeight*(a-f),f=a),f+p>b&&(p=1+b-a));for(;p--;){b=h[f];a=m[b];var k=f==c.selected&&!d.selectEdit;g.setColor(k?g.theme.bgH:g.theme.bg);g.fillRect(r,e,n,e+c.fontHeight-1);g.setColor(k?g.theme.fgH:g.theme.fg);g.setFontAlign(-1,-1);g.drawString(t.translate(b),
r+1,e+1);"object"==typeof a&&(b=n,k=a.value,a.format&&(k=a.format(k)),k=t.translate(""+k),d.selectEdit&&f==c.selected&&(b-=25,g.setColor(g.theme.bgH).fillRect(b-(g.stringWidth(k)+4),e,n,e+c.fontHeight-1),g.setColor(g.theme.fgH).drawImage("\f\u0005\u0081\x00 \u0007\x00\u00f9\u00f0\u000e\x00@",b,e+(c.fontHeight-10)/2,{scale:2})),g.setFontAlign(1,-1),g.drawString(k,b-2,e+1));g.setColor(g.theme.fg);e+=c.fontHeight;f++}g.setFontAlign(-1,-1);g.setColor(f<h.length?g.theme.fg:g.theme.bg).fillPoly([72,166,
104,166,88,174]);g.flip()},select:function(a){a=m[h[c.selected]];if("function"==typeof a)a(d);else if("object"==typeof a){if("number"==typeof a.value)d.selectEdit=d.selectEdit?void 0:a;else if("boolean"==typeof a.value&&(a.value=!a.value),a.onchange)a.onchange(a.value);d.draw()}},move:function(a){var b=d.selectEdit;if(b){b.value-=(a||1)*(b.step||1);void 0!==b.min&&b.value<b.min&&(b.value=b.min);void 0!==b.max&&b.value>b.max&&(b.value=b.max);if(b.onchange)b.onchange(b.value);d.draw(c.selected,c.selected)}else b=
c.selected,c.selected=(a+c.selected)%h.length,0>c.selected&&(c.selected+=h.length),d.draw(Math.min(b,c.selected),Math.max(b,c.selected))}};d.draw();Bangle.setUI("updown",a=>{a?d.move(a):d.select()});return d}Bangle.setUI()})